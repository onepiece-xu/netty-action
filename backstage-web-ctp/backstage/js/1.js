(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{267:function(t,e,a){"use strict";a.r(e);var n=a(286),i=a(273);for(var o in i)"default"!==o&&function(t){a.d(e,t,function(){return i[t]})}(o);var s=a(3),r=Object(s.a)(i.default,n.a,n.b,!1,null,null,null);r.options.__file="src/public/view/query/index.vue",e.default=r.exports},271:function(t,e,a){"use strict";a.r(e);var n=a(272),i=a.n(n);for(var o in n)"default"!==o&&function(t){a.d(e,t,function(){return n[t]})}(o);e.default=i.a},272:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={data:function(){return{active:0}},methods:{},props:["props"],watch:{props:function(t){this.active=t}}}},273:function(t,e,a){"use strict";a.r(e);var n=a(274),i=a.n(n);for(var o in n)"default"!==o&&function(t){a.d(e,t,function(){return n[t]})}(o);e.default=i.a},274:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,i=a(283),o=a(275),s=(n=o)&&n.__esModule?n:{default:n};e.default={data:function(){return{open:!1,hasRouteQuery:0,multipleSelection:[],dataList:[],pageInstan:{showPage:!1,Total:"",currentPage:1,pageSize:50,pageSizes:[10,20,50,100]},queryForm:{id:"",name:"",macAddr:"",intranetIp:"",status:""},globalSearchTerm:"",operationItemDisabled:!1,operationDialogVisible:!1,operationTitle:""}},components:{detailPage:s.default},methods:{handleSizeChange:function(t){this.pageInstan.pageSize=t,this.initData()},handleCurrentChange:function(t){this.pageInstan.currentPage=t,this.initData("","pageOne")},handleFilterChange:function(t){console.log(t),this.pageInstan.pageSize=50,this.pageInstan.currentPage=1,t.status&&(this.status=t.status[0]),this.initData()},initData:function(){var t=this,e={pageNum:this.pageInstan.currentPage,pageSize:this.pageInstan.pageSize};this.globalSearchTerm&&(e.search=this.globalSearchTerm),this.status&&(e.status=this.status),this.appStatus&&(e.appStatus=this.appStatus),(0,i.getDeviceList)(e).then(function(e){console.log(e),e&&e.data&&(t.dataList=e.data.records,t.dataList.length>0?(t.pageInstan.Total=e.data.total,t.pageInstan.showPage=!0):(t.pageInstan.Total=e.data.total,t.pageInstan.showPage=!1),t.optionData(t.dataList))})},optionData:function(t){t.forEach(function(t){t.status=0==t.status?"离线":"在线"})},restartItem:function(){this.type="shutdown",this.operationDialogVisible=!0,this.operationTitle="是否确认关闭选择的设备？"},rebootItem:function(){this.type="reboot",this.operationDialogVisible=!0,this.operationTitle="是否确认重启选择的设备？"},operation:function(){var t=this,e=[];this.multipleSelection.map(function(t){e.push(t.id)});var a=e;console.log(a),"shutdown"==this.type&&(0,i.shutdown)(a).then(function(e){console.log(e),t.operationDialogVisible=!1,t.initData()}),"reboot"==this.type&&(0,i.reboot)(a).then(function(e){console.log(e),t.operationDialogVisible=!1,t.initData()})},applyGlobalSearch:function(){this.initData()},searchItem:function(){this.initData()},emptyItem:function(){this.queryForm={}},refresh:function(){this.globalSearchTerm="",this.initData()},handleSelectionChange:function(t){this.multipleSelection=t},openItem:function(){this.open=!0},retractItem:function(){this.open=!1,this.queryForm={}},openStream:function(t){var e=this,a={deviceId:t};(0,i.connectStream)(a).then(function(t){t&&200==t.code?(t.data.deviceType=1,t.data.screen=1,window.setDeviceConnect(JSON.stringify(t.data)),window.open("#/run","_blank")):(e.$store.commit("connectError",{data:t,time:Date.now()}),e.$message.error("非常抱歉，暂时无法查看！"))})}},computed:{bth_check:function(){}},watch:{$route:function(){this.hasRouteQuery=this.$route.query.id?1:0}},mounted:function(){this.initData(),this.hasRouteQuery=this.$route.query.id?1:0}}},275:function(t,e,a){"use strict";a.r(e);var n=a(282),i=a(271);for(var o in i)"default"!==o&&function(t){a.d(e,t,function(){return i[t]})}(o);var s=a(3),r=Object(s.a)(i.default,n.a,n.b,!1,null,null,null);r.options.__file="src/public/common-tmpl/detail.vue",e.default=r.exports},282:function(t,e,a){"use strict";var n=function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{staticClass:"animateContent",class:[this.active?"animateIn":"animateOut"]},[e("div",{staticClass:"detailInner"},[this._t("default")],2)]),this._v(" "),e("div",{staticClass:"animate-backup"})])},i=[];n._withStripped=!0,a.d(e,"a",function(){return n}),a.d(e,"b",function(){return i})},283:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.connectStream=e.reboot=e.shutdown=e.getDeviceList=void 0;var n=o(a(82)),i=o(a(126));function o(t){return t&&t.__esModule?t:{default:t}}e.getDeviceList=function(t){return(0,n.default)({url:"/ctp-paas-control/device/getDeviceList",method:"GET",params:t,paramsSerializer:function(t){return i.default.stringify(t,{indices:!1})}})},e.shutdown=function(t){return(0,n.default)({url:"/ctp-paas-control/device/shutdown",method:"POST",data:t})},e.reboot=function(t){return(0,n.default)({url:"/ctp-paas-control/device/reboot",method:"POST",data:t})},e.connectStream=function(t){return(0,n.default)({url:"/ctp-paas-control/stream/connectStream",method:"GET",params:t,paramsSerializer:function(t){return i.default.stringify(t,{indices:!1})}})}},286:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"page-inner query"},[a("div",{staticClass:"table-action"},[a("button",{staticClass:"btn btn-info",attrs:{type:"button"},on:{click:t.restartItem}},[t._v("关机")]),t._v(" "),a("button",{staticClass:"btn btn-info",attrs:{type:"button"},on:{click:t.rebootItem}},[t._v("重启")]),t._v(" "),a("div",{staticClass:"pull-right"},[a("div",{staticClass:"search-box"},[a("form",{attrs:{name:"searchForm",novalidate:""},on:{submit:function(e){return e.preventDefault(),t.applyGlobalSearch()}}},[a("button",{staticClass:"btn",attrs:{type:"submit",disabled:!1}},[a("i",{staticClass:"icon-aw-search"})]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.globalSearchTerm,expression:"globalSearchTerm"}],staticClass:"form-control",attrs:{type:"text",autocomplete:"off",maxlength:"128",placeholder:"请输入设备名称/IP",name:"searchTerm"},domProps:{value:t.globalSearchTerm},on:{input:function(e){e.target.composing||(t.globalSearchTerm=e.target.value)}}})])]),t._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.$t("cn.tabelTips.refreshList"),placement:"top"}},[a("button",{staticClass:"btn btn-renovat btn-search",on:{click:function(e){return t.refresh()}}},[a("i",{staticClass:"icon-aw-refresh"})])])],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.open,expression:"open"}],staticClass:"btn-search"},[a("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:t.searchItem}},[t._v("搜索")]),t._v(" "),a("button",{staticClass:"btn btn-info",attrs:{type:"button"},on:{click:t.emptyItem}},[t._v("清空")])])]),t._v(" "),a("div",{staticClass:"table-content"},[a("el-table",{ref:"multipleTable",attrs:{data:t.dataList},on:{"filter-change":t.handleFilterChange,"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"40"}}),t._v(" "),a("el-table-column",{attrs:{prop:"id",label:"设备ID",width:"180px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{attrs:{title:e.row.id}},[t._v(t._s(e.row.id))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"设备名称",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{attrs:{title:e.row.name}},[t._v(t._s(e.row.name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"macAddr",label:"设备mac",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{attrs:{title:e.row.macAddr}},[t._v(t._s(e.row.macAddr))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"intranetIp",label:"设备内网管理IP",width:"170",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{attrs:{title:e.row.intranetIp}},[t._v(t._s(e.row.intranetIp))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"设备运行状态","column-key":"status","filter-multiple":!1,filters:[{text:"离线",value:0},{text:"在线",value:1}]},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{class:{"bg-green":"在线"==e.row.status,"bg-red":"离线"==e.row.status},attrs:{title:e.row.status}},[t._v(t._s(e.row.status))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"detail",label:"详情"},scopedSlots:t._u([{key:"default",fn:function(e){return"在线"==e.row.status?[a("span",{staticClass:"btn btn-primary",on:{click:function(a){return t.openStream(e.row.id)}}},[t._v("查看")])]:void 0}}],null,!0)})],1),t._v(" "),t.pageInstan.showPage?a("div",[t.pageInstan.showPage?a("page-query",{attrs:{currentPage:t.pageInstan.currentPage,total:t.pageInstan.Total,pageSize:t.pageInstan.pageSize},on:{handleSizeChangeSub:t.handleSizeChange,handleCurrentChangeSub:t.handleCurrentChange}}):t._e()],1):t._e(),t._v(" "),a("detail-page",{attrs:{props:t.hasRouteQuery}},[t.hasRouteQuery?a("equipment-detail",{attrs:{detailProps:{id:t.$route.query.id,name:t.$route.query.name}}}):t._e()],1)],1),t._v(" "),a("el-dialog",{attrs:{visible:t.operationDialogVisible,"custom-class":"small-dialog delete-dialog",center:"","close-on-click-modal":!1},on:{"update:visible":function(e){t.operationDialogVisible=e}}},[a("span",[t._v(t._s(t.operationTitle))]),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("button",{staticClass:"btn btn-warning",attrs:{type:"button",disabled:t.operationItemDisabled},on:{click:function(e){return t.operation()}}},[t._v(t._s(t.$t("cn.action.ok")))]),t._v(" "),a("button",{staticClass:"btn btn-default",attrs:{type:"button"},on:{click:function(e){t.operationDialogVisible=!1}}},[t._v(t._s(t.$t("cn.action.cancel")))])])])],1)])},i=[];n._withStripped=!0,a.d(e,"a",function(){return n}),a.d(e,"b",function(){return i})}}]);